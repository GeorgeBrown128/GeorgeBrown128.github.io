<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A simple GPS vehicle tracker.">
  <meta name="generator" content="Hugo 0.41" />

  <title>GPS Vehicle Tracker &middot; George Brown</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  

  <link rel="shortcut icon" href="https://electronics.digital/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/contact/"><i class='fa fa-envelope fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/GeorgeB128" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/GeorgeBrown128" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2018</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>GPS Vehicle Tracker</h1>
  <h2>A simple GPS vehicle tracker.</h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>06 Jul 2016, 20:26</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://electronics.digital/topics/electronics">electronics</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://electronics.digital/tags/electronics">electronics</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://electronics.digital/tags/development">development</a>
    
  </div>
  
  

</div>

  

<p>I frequently cover large distances by car, be it visiting friends or moving to
work or university. At the moment it seems I can&rsquo;t go very far without arriving
at some part of the country disrupted by <a href="https://en.wikipedia.org/wiki/Smart_motorway#Under construction">Smart
Motorway</a>
upgrades, horrible peak time traffic, or something else entirely!</p>

<p>I&rsquo;m normally <a href="http://www.theamphour.com">well</a>
<a href="http:/www.hellointernet.fm/">equipped</a> to deal with such hold ups, however
without the ability to contact people while on the road, I can&rsquo;t let them know
where I am.</p>

<p>The idea then is fairly simple - provide my current location on a map, so
people can see where I am in my journey. There are of course a multitude of
apps that can do this already, but how much you can trust a service provider
with your exact live location is questionable! Thus I decided to build my own!</p>

<p>This was another of my quick weekend projects that I one day hope to sit down
and polish up properly!</p>

<h1 id="design">Design</h1>

<p>There are three parts to this system:</p>

<ol>
<li>A GPS receiver that sends requests to a server.</li>
<li>A server to receive and record the incoming data.</li>
<li>A web front-end that allows users with permission to see the location data
on a map.</li>
</ol>

<h2 id="gps-receiver">GPS Receiver</h2>

<p>The GPS hardware itself is perhaps the most important part. At the moment I&rsquo;m
using a <a href="https://www.amazon.co.uk/dp/B0181TIY4U/ref=cm_sw_r_tw_dp_FcxFxbNW9Y6VG">module</a> based
on the <a href="https://www.u-blox.com/en/product/neo-6-series">ublox NEO-6M
receiver</a>. This module has a
serial output, transmitting a fairly standard set of <a href="https://en.wikipedia.org/wiki/NMEA_0183">NMEA 0183
sentences</a>. I&rsquo;ve worked with these
sentences before on a project at work, and was fully prepared to start writing
a parser for them in python. Perhaps I shouldn&rsquo;t have been so surprised to
discover though, that somebody else beat me to it! The <a href="https://github.com/Knio/pynmea2">pynmea2
package</a> shaved a bunch of time off the
development of this project.</p>

<p>In this prototype the GPS talks to my laptop via a <a href="http://www.ftdichip.com/Products/Cables/USBMPSSE.htm">C232HM
cable</a>. (which comes
highly recommended!) A python script reads in the sentences from the serial
port, picks out the ones it wants, and pulls the location and speed
information.</p>

<p>Every 10 seconds this data is passed to my server by a <a href="https://en.wikipedia.org/wiki/POST_(HTTP)">POST
request</a> using Python&rsquo;s <a href="http://docs.python-requests.org/en/master/">requests
library</a>. In keeping with the
security theme, the connection is SSL encrypted, and the page is password
protected to keep out any spoof requests.</p>

<p>For the moment, the internet connection is provided by my phone which is USB
tethered to my laptop. The signal has held up very well for the trips I&rsquo;ve
taken so far, apart from while travelling over hilly terrain in remote areas.
EE&rsquo;s promise to cover 99% of the population seems to hold up fairly well!</p>

<h2 id="receive-server">Receive Server</h2>

<p>All the web end scripts run on my VPS (the same one serving you this page!).</p>

<p>The receive server is really just a PHP page. Fortunately this wasn&rsquo;t
completely new to me, as an <a href="http://www.theiet.org/events/local/235137.cfm">IET
workshop</a> had given me a very
useful insight into what I needed to do. From there I developed a very
primitive framework for a few home automation projects that never took off.
Much of the code was still applicable here, so I repurposed it for this.</p>

<p>Once the location script has negotiated making an SSL connection and passing
htdigest authentication, then it is able to deliver it&rsquo;s POST data to the PHP
script. If all the fields are in order, the script pops the data into a .json
file, along with a timestamp. That&rsquo;s the job done, the server returns nothing
but an empty 200 OK header.</p>

<h2 id="web-front-end">Web Front-end</h2>

<p>The web front-end is possibly the most complicated body of code in the whole
system! It is written almost entirely in JavaScript, which was initially a bit
daunting. The C like syntax, and Python similarities made it pretty quick to
pick up however. There&rsquo;s plenty of other people out there asking the newbie
questions too, so it&rsquo;s fairly simple to find answers.</p>

<p>I&rsquo;m by no means a web developer, CSS is a whole new world to me, so as a
consequence, the webpage isn&rsquo;t beautiful. It doesn&rsquo;t need to be though!</p>

<p><a href="https://www.openstreetmap.org/">Openstreetmap</a> is used as the map source,
since I don&rsquo;t need to faff on with API tokens, simply generate an embed URL. I
have a reasonable degree of trust that my data isn&rsquo;t being farmed by OSM, and
of course it&rsquo;s free to use and distribute!</p>

<p>The JavaScript frequently refreshes an invisible iframe, which contains the
.json file generated by PHP script. When the timestamp in the file changes,
the JavaScript updates the embed URL for the map iframe. This causes the
content to reload, showing the user the new location. At the same time it also
updates the clock and speedometer.</p>


<div class="pure-u-1-1">
  <img class="pure-img" src="img/gps-web-frontend.png" alt="GPS Tracker web frontend screenshot">
</div>


<p>This is the current state of the web interface, it&rsquo;s functional, but there&rsquo;s
room for improvement! <a href="http://www.openstreetmap.org/copyright">Map Data &copy; OpenStreetMap
contributors</a></p>

<h1 id="conclusion">Conclusion</h1>

<p>The current state of the project is little more than a proof of concept. I do
hope to improve this project and make it a permanent installation. This means
I don&rsquo;t have to worry about remembering to fit the hardware to the car each
time I need it, and I can potentially use it for my own data analysis, as well
as track my car if it&rsquo;s ever stolen! (it&rsquo;s a &lsquo;08 Citroën C1 - who&rsquo;s going to
nick that‽)</p>

<p>The next steps for this project are:</p>

<ol>
<li>Move everything to a raspberry pi or another internet capable platform
(ESP8266?).</li>
<li>Hide the GPS hardware inside the dashboard.</li>
<li>Investigate fitting a data modem with external antennas, this should help
improve coverage in poor signal areas.</li>
<li>Spruce up the web interface.</li>
<li>Look into connecting the system up as an APRS sender, and possibly as a
mobile APRS igate.</li>
<li>Get the compute platform in the car to do all sorts of other stuff!</li>
</ol>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://electronics.digital/post/tapemeasure-yagi/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://electronics.digital/post/tapemeasure-yagi/">2m Tape Measure Yagi Antenna</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://electronics.digital/post/hp1652b-power-repair/">HP1652B Power Inlet Repair</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://electronics.digital/post/hp1652b-power-repair/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://electronics.digital/js/ui.js"></script>

</body>
</html>

